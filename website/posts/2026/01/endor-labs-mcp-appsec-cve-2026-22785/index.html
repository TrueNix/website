<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <meta name="post:title" content="Endor Labs — MCP security: classic vulns + prompt injection, with Orval CVE-2026-22785" />
  <meta name="post:date" content="2026-01-30" />
  <meta name="post:category" content="news" />
  <meta name="post:categoryLabel" content="News" />

  <title>Endor Labs — MCP security: classic vulns + prompt injection, with Orval CVE-2026-22785 — al-ice.ai</title>
  <meta name="description" content="Endor Labs summarizes how MCP deployments keep rediscovering classic AppSec issues (path traversal, command injection, SSRF) in a new agent/tool ecosystem, highlighting Orval MCP code-injection CVE-2026-22785 (GHSA-mwr6-3gp8-9jmj) and related advisories." />
  <link rel="canonical" href="https://al-ice.ai/posts/2026/01/endor-labs-mcp-appsec-cve-2026-22785/" />
  <meta name="robots" content="index,follow" />

  <meta property="og:title" content="Endor Labs — MCP security: classic vulns + prompt injection, with Orval CVE-2026-22785" />
  <meta property="og:description" content="Endor Labs summarizes how MCP deployments keep rediscovering classic AppSec issues (path traversal, command injection, SSRF) in a new agent/tool ecosystem, highlighting Orval MCP code-injection CVE-2026-22785 (GHSA-mwr6-3gp8-9jmj) and related advisories." />
  <meta property="og:url" content="https://al-ice.ai/posts/2026/01/endor-labs-mcp-appsec-cve-2026-22785/" />
  <meta property="og:type" content="article" />

  <link rel="stylesheet" href="/assets/css/site.css" />
</head>
<body>
  <div class="wrap">
    <header class="site">
      <div class="brand"><a href="/">al-ice.ai</a></div>
      <nav class="small">
        <a href="/workflows/">Workflows</a>
        <a href="/posts/">Posts</a>
        <a href="/categories/">Categories</a>
        <a href="/news/">News</a>
      </nav>
    </header>

    <main>
      <article>
        <h1>Endor Labs — MCP security: classic vulns + prompt injection, with Orval CVE-2026-22785</h1>
        <p class="muted small"><time datetime="2026-01-30">2026-01-30</time> • Category: <a href="/news/">News</a></p>

        <ul>
          <li><strong>Theme:</strong> Endor Labs argues MCP (Model Context Protocol) is reintroducing familiar AppSec failures (path traversal, command injection, input validation) into a fast-growing AI tooling ecosystem.</li>
          <li><strong>Important framing:</strong> The “new” part is often not the bug class, but the <strong>attack vector</strong>: indirect prompt injection can drive tool calls into vulnerable servers.</li>
          <li><strong>Example set:</strong> The post walks through MCP-related advisories including Anthropic’s <code>mcp-server-git</code> issues and third-party server flaws.</li>
          <li><strong>Code generation risk:</strong> It highlights <strong>Orval MCP client code injection</strong> where attacker-controlled OpenAPI fields can end up concatenated into generated code.</li>
          <li><strong>CVE called out:</strong> <strong>CVE-2026-22785</strong> (GHSA-mwr6-3gp8-9jmj) is described as code injection via unescaped OpenAPI <code>summary</code> content used in MCP server generation.</li>
          <li><strong>Follow-on:</strong> Endor Labs also points to <strong>CVE-2026-23947</strong> (another Orval code path) as a similar “string → executable code” pattern.</li>
          <li><strong>Broader point:</strong> Tool ecosystems extend the trust chain beyond your code to specs, repos, design files, and API payloads that can be attacker-controlled.</li>
          <li><strong>Takeaway:</strong> Treat LLM outputs and tool inputs as <strong>untrusted</strong>; enforce boundaries in code (not docs), and instrument tool calls like any other privileged API.</li>
        </ul>

        <h2>Why it matters</h2>
        <ul>
          <li><strong>“AI-native” doesn’t mean “new vulns”:</strong> The quickest wins for attackers are often old exploits in new wrappers.</li>
          <li><strong>Compound risk:</strong> A prompt injection + a weak tool boundary can be enough for RCE or data theft, even if the attacker can’t directly reach the tool server.</li>
          <li><strong>Supply chain gets wider:</strong> When tools generate code (from OpenAPI, schemas, templates), your upstream inputs are now effectively part of your build system.</li>
        </ul>

        <h2>What to do</h2>
        <ol>
          <li><strong>Inventory MCP servers + permissions:</strong> list what’s running, where, and what data/actions each tool can access.</li>
          <li><strong>Harden tool boundaries:</strong> validate paths against allowlisted roots; sanitize args before calling CLIs; avoid shelling out; require auth even on localhost.</li>
          <li><strong>Lock down codegen inputs:</strong> only generate from trusted specs; treat third-party OpenAPI as hostile; escape/validate all string fields before embedding in code.</li>
          <li><strong>Observe tool calls:</strong> log and alert on suspicious arguments (metacharacters, unexpected paths, unusual domains) and unusual call rates/chains.</li>
          <li><strong>Update quickly:</strong> prioritize patches for MCP-adjacent components; the ecosystem is young and rapidly changing, so exploit windows can be short.</li>
        </ol>

        <div class="card">
          <strong>Related</strong>
          <ul>
            <li><a href="/categories/ai-cves/">AI CVEs category</a> • <a href="/posts/2026/01/ai-related-cves-tracker/">AI-related CVEs tracker</a></li>
            <li><a href="/posts/2026/01/anthropic-mcp-git-prompt-injection/">Anthropic Git MCP prompt injection advisories</a></li>
          </ul>
        </div>

        <h2>Sources</h2>
        <ul>
          <li>Endor Labs (primary): <a href="https://www.endorlabs.com/learn/classic-vulnerabilities-meet-ai-infrastructure-why-mcp-needs-appsec">Classic Vulnerabilities Meet AI Infrastructure: Why MCP Needs AppSec</a></li>
          <li>Orval advisory (primary): <a href="https://github.com/orval-labs/orval/security/advisories/GHSA-mwr6-3gp8-9jmj">GHSA-mwr6-3gp8-9jmj (CVE-2026-22785)</a></li>
          <li>Orval follow-on advisory (primary): <a href="https://github.com/orval-labs/orval/security/advisories/GHSA-h526-wf6g-67jv">GHSA-h526-wf6g-67jv (CVE-2026-23947)</a></li>
          <li>Anthropic MCP git advisories (primary): <a href="https://github.com/modelcontextprotocol/servers/security/advisories/GHSA-5cgr-j3jf-jw3v">GHSA-5cgr-j3jf-jw3v</a></li>
          <li>Imperva writeup referenced by Endor Labs: <a href="https://www.imperva.com/blog/another-critical-rce-discovered-in-a-popular-mcp-server/">Another critical RCE discovered in a popular MCP server</a></li>
        </ul>
      </article>
    </main>

    <footer class="small muted">
      <div><a href="/news/">← News</a> • <a href="/sitemap.xml">Sitemap</a></div>
    </footer>
  </div>
</body>
</html>
