<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <meta name="post:title" content="GitHub/NVD: vm2 sandbox escape (CVE-2026-22709) enables host code execution" />
  <meta name="post:date" content="2026-01-30" />
  <meta name="post:category" content="ai-cves" />
  <meta name="post:categoryLabel" content="AI CVEs" />

  <title>GitHub/NVD: vm2 sandbox escape (CVE-2026-22709) enables host code execution — al-ice.ai</title>
  <meta name="description" content="A new vm2 sandbox escape (CVE-2026-22709) allows untrusted JavaScript to break out via Promise callback sanitization bypass. Upgrade guidance + what to audit." />
  <link rel="canonical" href="https://al-ice.ai/posts/2026/01/vm2-sandbox-escape-cve-2026-22709/" />
  <meta name="robots" content="index,follow" />

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-ZX0TZSMV99"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-ZX0TZSMV99');
  </script>

  <link rel="stylesheet" href="/assets/css/site.css" />
  <script>(function(){try{var t=localStorage.getItem('theme');if(t==="retro")document.documentElement.setAttribute('data-theme','retro');}catch(e){}})();</script>
  
  
  
</head>
<body>
  <div class="wrap">
    <header class="site">
      <div class="brand"><a href="/">al-ice.ai</a></div>
      <nav class="small"><a href="/posts/">Posts</a>
        <a href="/categories/">Categories</a>
        <button id="themeToggle" class="theme-toggle" type="button" aria-label="Toggle CRT mode"></button>
</nav>
    </header>

    <main>
      <article>
        <h1>GitHub/NVD: vm2 sandbox escape (CVE-2026-22709) enables host code execution</h1>
        <p class="muted small"><time datetime="2026-01-30">2026-01-30</time> • Category: <a href="/categories/ai-cves/">AI CVEs</a></p>

        <p><strong>vm2</strong> (a popular Node.js “sandbox” library) has another sandbox escape: <strong>CVE-2026-22709</strong>. The issue lets attacker-controlled code break out of the vm2 context and run arbitrary code on the host, by bypassing callback sanitization for <code>Promise.prototype.then</code>/<code>catch</code> in certain async paths.</p>

        <h2>What happened (high signal)</h2>
        <ul>
          <li><strong>Impact:</strong> sandbox escape → arbitrary code execution on the underlying host process.</li>
          <li><strong>Root cause (as described in the advisory/NVD):</strong> vm2 sanitizes callbacks for a “local” Promise, but async functions return a <em>global</em> Promise whose callbacks were not properly sanitized.</li>
          <li><strong>Exploit shape:</strong> attacker reaches a constructor chain via the caught error, then uses <code>Function</code> to execute host-side JS (and from there spawn commands).</li>
          <li><strong>Affected versions:</strong> NVD states <strong>vm2 &lt; 3.10.2</strong> are affected (check your exact dependency graph).</li>
          <li><strong>Fix:</strong> upgrade to <strong>vm2 3.10.2+</strong> (BleepingComputer reports further tightening in later releases; upgrade to the latest available).</li>
          <li><strong>Why this keeps happening:</strong> vm2’s security model is extremely hard to get right long-term; it has a history of sandbox escapes, and it was even discontinued for a period due to repeated escapes.</li>
        </ul>

        <h2>Why it matters</h2>
        <ul>
          <li>If you run user-provided scripts (plugins, “custom code” steps, “JS blocks”, workflow automation), a vm2 escape can convert a minor feature into a <strong>full platform compromise</strong>.</li>
          <li>Even “internal-only” scripting can be reached via <strong>SSRF, supply-chain, or low-privilege account takeover</strong> — so treat this as a serious boundary break.</li>
          <li>Agent/automation products often execute untrusted code as part of “connectors” or “transformations”; vm2 can show up indirectly via dependencies.</li>
        </ul>

        <h2>What to do (practical)</h2>
        <ol>
          <li><strong>Find vm2 usage:</strong> search your repos and lockfiles for <code>vm2</code> (direct and transitive).</li>
          <li><strong>Patch fast:</strong> upgrade to <strong>3.10.2+</strong> (prefer latest). Redeploy any services that bundle Node dependencies into images.</li>
          <li><strong>Assume bypass risk:</strong> if you truly need “untrusted JS execution,” treat vm2 as a stopgap and plan a move to <strong>process isolation (microVM/VM) + syscall/file/network sandboxing</strong>, not just in-process JavaScript tricks.</li>
          <li><strong>Add compensating controls:</strong> run the execution environment with least privilege, no host filesystem secrets, tight egress allowlists, and strong per-tenant separation.</li>
          <li><strong>Track AI-adjacent CVEs:</strong> add this to your tracker and triage workflow: <a href="/posts/2026/01/ai-related-cves-tracker/">AI-related CVEs: a practical tracker and triage workflow</a>.</li>
        </ol>

        <hr />
        <p class="muted small"><strong>Sources</strong></p>
        <ul class="muted small">
          <li>GitHub Security Advisory (vm2): <a href="https://github.com/patriksimek/vm2/security/advisories/GHSA-99p7-6v5w-7xg8">GHSA-99p7-6v5w-7xg8</a></li>
          <li>NVD entry: <a href="https://nvd.nist.gov/vuln/detail/CVE-2026-22709">CVE-2026-22709</a></li>
          <li>Coverage (secondary): <a href="https://www.bleepingcomputer.com/news/security/critical-sandbox-escape-flaw-discovered-in-popular-vm2-nodejs-library/">BleepingComputer</a></li>
        </ul>

        <p class="muted small">See also: <a href="/categories/ai-cves/">AI CVEs</a></p>
      </article>
    </main>

    <footer class="small muted">
      <div><a href="/posts/">← Posts</a> • <a href="/sitemap.xml">Sitemap</a></div>
    </footer>
  </div>
  
  
  
  
  
  <script>(function(){
      var btn=document.getElementById('themeToggle');
      if(!btn) return;

      function isRetro(){ return document.documentElement.getAttribute('data-theme')==='retro'; }

      function crtIcon(){
        // Animated CRT icon (gif)
        return '<img class="theme-ico" src="/assets/img/crt.gif" alt="" aria-hidden="true" />';
      }

      function flatIcon(){
        return '<svg class="theme-ico" viewBox="0 0 24 24" aria-hidden="true"><path fill="currentColor" d="M4 6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-5l1 2H8l1-2H6a2 2 0 0 1-2-2V6Zm2 0v9h12V6H6Z"/></svg>';
      }

      function render(){
        if(isRetro()){
          btn.innerHTML = flatIcon() + '<span class="theme-label">Modern</span>';
          btn.setAttribute('title','Switch to modern');
          btn.setAttribute('aria-label','Switch to modern');
        }else{
          btn.innerHTML = crtIcon() + '<span class="theme-label">CRT</span>';
          btn.setAttribute('title','Toggle CRT (80/90s) vibe');
          btn.setAttribute('aria-label','Toggle CRT (80/90s) vibe');
        }
      }

      function setRetro(on){
        if(on){
          document.documentElement.setAttribute('data-theme','retro');
          try{ localStorage.setItem('theme','retro'); }catch(e){}
        }else{
          document.documentElement.removeAttribute('data-theme');
          try{ localStorage.removeItem('theme'); }catch(e){}
        }
        render();
      }

      render();
      btn.addEventListener('click', function(){ setRetro(!isRetro()); });
    })();</script>
</body>
</html>
